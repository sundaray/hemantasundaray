---
title: How to use Framer Motion with Next.js Server Components
description: "Check out my first blog post."
author: Hemanta Sundaray
publishedAt: 30-04-2024
tags: ["Framer Motion", "Next.js"]
published: true
---

import { BlogPostLayout } from "@/components/blog-post-layout";

<BlogPostLayout frontmatter={frontmatter}>

In Next.js App Router, pages are Server Components by default.
This means that if you want to add animations to your components using Framer Motion, you can't directly use the `motion` component provided by Framer Motion.
This is because the `motion` component needs access to DOM nodes to perform animations; however, Server Components in Next.js run on the server and don't have access to the DOM.

Let's explore how to solve this problem.

## The Problem

Letâ€™s say you have a component like this:

```tsx
export default function HomePage() {
  return <h1>Welcome Home!</h1>;
}
```

This is a Server Component. When this component renders, you want to give the `h1` element an enter animation: fade in and slide up from the bottom. However, because `<HomePage>` is a Server Component, you can't directly convert the `h1` to a motion component like this:

```jsx
import { motion } from "framer-motion";

export default function HomePage() {
  return (
    <motion.h1 initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>
      Work Experience
    </motion.h1>
  );
}
```

This will raise an error:

![Server Error](/images/blog/motion-component-error.jpg)

## The Solution

To solve this problem, we need to create a custom motion component that wraps the `motion` component from Framer Motion. This custom component will be a Client Component, which we can use inside Server Components.

Here's how you can create a custom motion component:

```tsx
import { motion } from "framer-motion";
import type { HTMLMotionProps } from "framer-motion";
import React from "react";

type MotionH1Props = HTMLMotionProps<"h1">;

const MotionH1 = React.forwardRef<HTMLHeadingElement, MotionH1Props>(
  ({ children, className, ...props }, ref) => (
    <motion.h1 ref={ref} className={className} {...props}>
      {children}
    </motion.h1>
  ),
);

MotionH1.displayName = "MotionH1";

export { MotionH1 };
```

Let's break down what's happening in this code:

- We import the `motion` component and the `HTMLMotionProps` type from the Framer Motion library.
  Note that `HTMLMotionProps` is a generic type, meaning it's designed to be used with a type parameter that specifies the kind of DOM element it is intended to describe.

### Typing forwardrefs

The syntax for `forwardRef` with TypeScript looks like this:

```tsx
const Component = React.forwardRef<RefType, PropsType>((props, ref) => {
  // Component implementation
});
```

To type `forwardRef`, we need two type parameters:

- `RefType`: Represents the type of the DOM element that the `ref` will be attached to. In our case, it's `HTMLHeadingElement` because we're rendering an `<h1>` element.
- `PropsType`: Represents the props that the component will receive. We define this as `MotionH1Props`, which is an alias for `HTMLMotionProps<'h1'>`.

`HTMLMotionProps` is a generic type provided by Framer Motion that represents the props for a motion component based on a specific HTML element. By passing `h1` to `HTMLMotionProps`, we're telling it to include all the valid props for an `<h1>` element along with motion-specific props (such as `initial`, `animate`, and `exit` ) from Framer Motion.

```tsx
import { MotionH1 } from "@/components/motion-components";

export function WorkExperience() {
  return (
    <MotionH1
      initial={{ opacity: 0, y: 50 }}
      animate={{ opacity: 1, y: 0 }}
      className="text-2xl font-bold"
    >
      Work Experience
    </MotionH1>
  );
}
```

## Conclusion

Now you know how to use

</BlogPostLayout>
